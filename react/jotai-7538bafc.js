import{r as D,a as J}from"./react-e483b31d.js";let q=0;function j(e,o){const r=`atom${++q}`,d={toString:()=>r};return typeof e=="function"?d.read=e:(d.init=e,d.read=function(l){return l(this)},d.write=function(l,u,L){return u(this,typeof L=="function"?L(l(this)):L)}),o&&(d.write=o),d}const w=e=>"init"in e,B=e=>!!e.write,b=new WeakMap,$=(e,o)=>{b.set(e,o),e.catch(()=>{}).finally(()=>b.delete(e))},W=(e,o)=>{const r=b.get(e);r&&(b.delete(e),r(o))},H=(e,o)=>{e.status="fulfilled",e.value=o},G=(e,o)=>{e.status="rejected",e.reason=o},Q=e=>typeof(e==null?void 0:e.then)=="function",h=(e,o)=>!!e&&"v"in e&&"v"in o&&Object.is(e.v,o.v),k=(e,o)=>!!e&&"e"in e&&"e"in o&&Object.is(e.e,o.e),R=e=>!!e&&"v"in e&&e.v instanceof Promise,ee=(e,o)=>"v"in e&&"v"in o&&e.v.orig&&e.v.orig===o.v.orig,P=e=>{if("e"in e)throw e.e;return e.v},te=()=>{const e=new WeakMap,o=new WeakMap,r=new Map;let d,l;const u=t=>e.get(t),L=(t,_)=>{const E=e.get(t);if(e.set(t,_),r.has(t)||r.set(t,E),R(E)){const n="v"in _?_.v instanceof Promise?_.v:Promise.resolve(_.v):Promise.reject(_.e);E.v!==n&&W(E.v,n)}},A=(t,_,E)=>{const n=new Map;let i=!1;E.forEach((T,I)=>{!T&&I===t&&(T=_),T&&(n.set(I,T),_.d.get(I)!==T&&(i=!0))}),(i||_.d.size!==n.size)&&(_.d=n)},O=(t,_,E)=>{const n=u(t),i={d:(n==null?void 0:n.d)||new Map,v:_};if(E&&A(t,i,E),h(n,i)&&n.d===i.d)return n;if(R(n)&&R(i)&&ee(n,i)){if(n.d===i.d)return n;i.v=n.v}return L(t,i),i},f=(t,_,E,n)=>{if(Q(_)){let i;const T=()=>{const c=u(t);if(!R(c)||c.v!==I)return;const S=O(t,I,E);o.has(t)&&c.d!==S.d&&M(t,S,c.d)},I=new Promise((c,S)=>{let s=!1;_.then(a=>{s||(s=!0,H(I,a),c(a),T())},a=>{s||(s=!0,G(I,a),S(a),T())}),i=a=>{s||(s=!0,a.then(V=>H(I,V),V=>G(I,V)),c(a))}});return I.orig=_,I.status="pending",$(I,c=>{c&&i(c),n==null||n()}),O(t,I,E)}return O(t,_,E)},v=(t,_,E)=>{const n=u(t),i={d:(n==null?void 0:n.d)||new Map,e:_};return E&&A(t,i,E),k(n,i)&&n.d===i.d?n:(L(t,i),i)},p=(t,_)=>{const E=u(t);if(!_&&E&&(o.has(t)||Array.from(E.d).every(([s,a])=>{if(s===t)return!0;const V=p(s);return V===a||h(V,a)})))return E;const n=new Map;let i=!0;const T=s=>{if(s===t){const V=u(s);if(V)return n.set(s,V),P(V);if(w(s))return n.set(s,void 0),s.init;throw new Error("no atom init")}const a=p(s);return n.set(s,a),P(a)};let I,c;const S={get signal(){return I||(I=new AbortController),I.signal},get setSelf(){return!c&&B(t)&&(c=(...s)=>{if(!i)return N(t,...s)}),c}};try{const s=t.read(T,S);return f(t,s,n,()=>I==null?void 0:I.abort())}catch(s){return v(t,s,n)}finally{i=!1}},x=t=>P(p(t)),K=t=>{let _=o.get(t);return _||(_=C(t)),_},m=(t,_)=>!_.l.size&&(!_.t.size||_.t.size===1&&_.t.has(t)),X=t=>{const _=o.get(t);_&&m(t,_)&&U(t)},Y=t=>{const _=new Map,E=new WeakMap,n=I=>{var c;const S=new Set((c=o.get(I))==null?void 0:c.t);return r.forEach((s,a)=>{var V;(V=u(a))!=null&&V.d.has(I)&&S.add(a)}),S},i=I=>{n(I).forEach(c=>{c!==I&&(_.set(c,(_.get(c)||new Set).add(I)),E.set(c,(E.get(c)||0)+1),i(c))})};i(t);const T=I=>{n(I).forEach(c=>{var S;if(c!==I){let s=E.get(c);if(s&&E.set(c,--s),!s){let a=!!((S=_.get(c))!=null&&S.size);if(a){const V=u(c),Z=p(c,!0);a=!h(V,Z)}a||_.forEach(V=>V.delete(c))}T(c)}})};T(t)},F=(t,..._)=>{let E=!0;const n=I=>P(p(I)),i=(I,...c)=>{let S;if(I===t){if(!w(I))throw new Error("atom not writable");const s=u(I),a=f(I,c[0]);h(s,a)||Y(I)}else S=F(I,...c);if(!E){const s=g()}return S},T=t.write(n,i,..._);return E=!1,T},N=(t,..._)=>{const E=F(t,..._),n=g();return E},C=(t,_,E)=>{var n;const i=E||[];(n=u(t))==null||n.d.forEach((I,c)=>{const S=o.get(c);S?S.t.add(t):c!==t&&C(c,t,i)}),p(t);const T={t:new Set(_&&[_]),l:new Set};if(o.set(t,T),B(t)&&t.onMount){const{onMount:I}=t;i.push(()=>{const c=I((...S)=>N(t,...S));c&&(T.u=c)})}return E||i.forEach(I=>I()),T},U=t=>{var _;const E=(_=o.get(t))==null?void 0:_.u;E&&E(),o.delete(t);const n=u(t);n&&(R(n)&&W(n.v),n.d.forEach((i,T)=>{if(T!==t){const I=o.get(T);I&&(I.t.delete(t),m(T,I)&&U(T))}}))},M=(t,_,E)=>{const n=new Set(_.d.keys());E==null||E.forEach((i,T)=>{if(n.has(T)){n.delete(T);return}const I=o.get(T);I&&(I.t.delete(t),m(T,I)&&U(T))}),n.forEach(i=>{const T=o.get(i);T?T.t.add(t):o.has(t)&&C(i,t)})},g=()=>{let t;for(;r.size;){const _=Array.from(r);r.clear(),_.forEach(([E,n])=>{const i=u(E);if(i){const T=o.get(E);T&&i.d!==(n==null?void 0:n.d)&&M(E,i,n==null?void 0:n.d),T&&!(!R(n)&&(h(n,i)||k(n,i)))&&T.l.forEach(I=>I())}})}};return{get:x,set:N,sub:(t,_)=>{const E=K(t),n=g(),i=E.l;return i.add(_),()=>{i.delete(_),X(t)}}}};let y;const ne=()=>(y||(y=te()),y),oe=D.createContext(void 0),z=e=>{const o=D.useContext(oe);return(e==null?void 0:e.store)||o||ne()},_e=e=>typeof(e==null?void 0:e.then)=="function",Ie=J.use||(e=>{if(e.status==="pending")throw e;if(e.status==="fulfilled")return e.value;throw e.status==="rejected"?e.reason:(e.status="pending",e.then(o=>{e.status="fulfilled",e.value=o},o=>{e.status="rejected",e.reason=o}),e)});function Ee(e,o){const r=z(o),[[d,l,u],L]=D.useReducer(f=>{const v=r.get(e);return Object.is(f[0],v)&&f[1]===r&&f[2]===e?f:[v,r,e]},void 0,()=>[r.get(e),r,e]);let A=d;(l!==r||u!==e)&&(L(),A=r.get(e));const O=o==null?void 0:o.delay;return D.useEffect(()=>{const f=r.sub(e,()=>{if(typeof O=="number"){setTimeout(L,O);return}L()});return L(),f},[r,e,O]),D.useDebugValue(A),_e(A)?Ie(A):A}function ie(e,o){const r=z(o);return D.useCallback((...l)=>r.set(e,...l),[r,e])}function Ae(e,o){return[Ee(e,o),ie(e,o)]}const ce=Symbol(),Te=e=>typeof(e==null?void 0:e.then)=="function";function re(e){let o,r;const d={getItem:(l,u)=>{var L,A;const O=v=>{if(v=v||"",o!==v){try{r=JSON.parse(v)}catch{return u}o=v}return r},f=(A=(L=e())==null?void 0:L.getItem(l))!=null?A:null;return Te(f)?f.then(O):O(f)},setItem:(l,u)=>{var L;return(L=e())==null?void 0:L.setItem(l,JSON.stringify(u))},removeItem:l=>{var u;return(u=e())==null?void 0:u.removeItem(l)}};return typeof window<"u"&&typeof window.addEventListener=="function"&&window.Storage&&(d.subscribe=(l,u,L)=>{if(!(e()instanceof window.Storage))return()=>{};const A=O=>{if(O.storageArea===e()&&O.key===l){let f;try{f=JSON.parse(O.newValue||"")}catch{f=L}u(f)}};return window.addEventListener("storage",A),()=>{window.removeEventListener("storage",A)}}),d}const se=re(()=>typeof window<"u"?window.localStorage:void 0);function Oe(e,o,r=se,d){const l=d==null?void 0:d.unstable_getOnInit,u=j(l?r.getItem(e,o):o);return u.onMount=A=>{l||A(r.getItem(e,o));let O;return r.subscribe&&(O=r.subscribe(e,A,o)),O},j(A=>A(u),(A,O,f)=>{const v=typeof f=="function"?f(A(u)):f;return v===ce?(O(u,o),r.removeItem(e)):v instanceof Promise?v.then(p=>(O(u,p),r.setItem(e,p))):(O(u,v),r.setItem(e,v))})}export{Oe as a,j as b,ie as c,Ee as d,re as e,Ae as u};
